{"ast":null,"code":"import _classCallCheck from \"/Users/chengang/Desktop/d3-demo/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/chengang/Desktop/d3-demo/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/chengang/Desktop/d3-demo/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/chengang/Desktop/d3-demo/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/chengang/Desktop/d3-demo/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/chengang/Desktop/d3-demo/src/App.js\";\nimport React, { Component } from 'react';\nimport * as d3 from 'd3';\nvar num = [[{\n  \"number\": 1,\n  \"name\": \"one\"\n}, {\n  \"number\": 2,\n  \"name\": \"two\"\n}, {\n  \"number\": 3,\n  \"name\": \"three\"\n}]];\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n    _this.state = {\n      dataset: [{\n        \"number\": 1,\n        \"name\": \"one\"\n      }, {\n        \"number\": 2,\n        \"name\": \"two\"\n      }, {\n        \"number\": 3,\n        \"name\": \"three\"\n      }],\n      data: []\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      setInterval(function () {\n        fetch('http://localhost:8080/data.json').then(function (req) {\n          return req.json();\n        }).then(function (res) {\n          _this2.setState({\n            data: res.data\n          }, function () {\n            num.push(_this2.state.data);\n\n            _this2.drawChart();\n          });\n        });\n      }, 2000);\n    }\n  }, {\n    key: \"drawChart\",\n    value: function drawChart() {\n      var _this3 = this;\n\n      var width = 400,\n          height = 400;\n      var svg = d3.select('svg').attr('width', width).attr('height', height);\n      svg.selectAll('*').remove();\n      var outerRadius = 150,\n          innerRadius = 0;\n      var arc = d3.arc().innerRadius(innerRadius).outerRadius(outerRadius);\n      var pie = d3.pie().value(function (d) {\n        return d.number;\n      }).sort(function (a, b) {\n        return a.name.localeCompare(b.name);\n      });\n      var color = d3.scaleOrdinal(d3.schemeCategory10);\n      var path = svg.selectAll('path').data(pie(num.shift())).enter().append('path').attr('transform', 'translate(' + width / 2 + ',' + width / 2 + ')').attr('d', arc).attr('fill', function (d, i) {\n        return color(i);\n      });\n      path.transition().duration(1000).attrTween('d', function (d, i) {\n        var compute = d3.interpolate(d, pie(_this3.state.data)[i]);\n        return function (t) {\n          d = compute(t);\n          return arc(d);\n        };\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"svg\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/Users/chengang/Desktop/d3-demo/src/App.js"],"names":["React","Component","d3","num","App","props","state","dataset","data","setInterval","fetch","then","req","json","res","setState","push","drawChart","width","height","svg","select","attr","selectAll","remove","outerRadius","innerRadius","arc","pie","value","d","number","sort","a","b","name","localeCompare","color","scaleOrdinal","schemeCategory10","path","shift","enter","append","i","transition","duration","attrTween","compute","interpolate","t"],"mappings":"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","sourcesContent":["import React,{ Component } from 'react';\nimport * as d3 from 'd3';\n\nvar num = [[{\"number\":1,\"name\":\"one\"},{\"number\":2,\"name\":\"two\"},{\"number\":3,\"name\":\"three\"}]];\n\n\nclass App extends Component {\n  constructor(props){\n    super(props);\n    this.state={\n      dataset: [{\n        \"number\":1,\"name\":\"one\"\n      },{\"number\":2,\"name\":\"two\"},{\"number\":3,\"name\":\"three\"}],\n      data:[]\n    }\n  }\n  componentDidMount(){\n    setInterval(() => {\n      fetch('http://localhost:8080/data.json').then((req) => {\n        return req.json()\n      }).then((res) => {\n        this.setState({\n          data: res.data\n        },() => {\n          num.push(this.state.data);\n          this.drawChart();\n        })\n      })\n    },2000)\n  }\n  drawChart(){\n    var width = 400,height = 400;\n    var svg = d3.select('svg').attr('width',width).attr('height',height);\n    svg.selectAll('*').remove();\n    var outerRadius = 150,innerRadius = 0;\n    var arc = d3.arc()\n      .innerRadius(innerRadius)\n      .outerRadius(outerRadius);\n    \n    var pie = d3.pie().value(function(d){return d.number}).sort(function(a,b){return a.name.localeCompare(b.name)});\n    var color = d3.scaleOrdinal(d3.schemeCategory10);\n    var path = svg.selectAll('path')\n      .data(pie(num.shift()))\n      .enter()\n      .append('path')\n      .attr('transform','translate('+(width/2)+','+(width/2) +')')\n      .attr('d',arc)\n      .attr('fill',(d,i) =>{\n        return color(i)\n      })\n\n      path.transition().duration(1000).attrTween('d',(d,i) => {\n        var compute = d3.interpolate(d,pie(this.state.data)[i]);\n        return function(t){\n          d = compute(t);\n          return arc(d)\n        }\n      })\n  }\n  render(){\n    return(\n      <svg className=\"App\">\n      </svg>\n    )\n  }\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}